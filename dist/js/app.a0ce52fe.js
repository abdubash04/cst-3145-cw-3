(function(){"use strict";var t={2530:function(t,e,r){var o=r(5130),n=r(6768),s=r(4232);const a={id:"app",class:"container"},c=(0,n.Lk)("header",null,[(0,n.Lk)("h2",null,"A1 Lessons")],-1);function i(t,e,r,o,i,u){const l=(0,n.g2)("ProductList"),d=(0,n.g2)("CheckoutComponent");return(0,n.uX)(),(0,n.CE)("div",a,[c,(0,n.Lk)("main",null,["ProductList"===i.activeComponent?((0,n.uX)(),(0,n.Wv)(l,{key:0,onAddToCart:u.addToCart,onRemoveFromCart:u.removeFromCart},null,8,["onAddToCart","onRemoveFromCart"])):(0,n.Q3)("",!0),"CheckoutComponent"===i.activeComponent?((0,n.uX)(),(0,n.Wv)(d,{key:1,cart:i.cart,onRemoveFromCart:u.removeFromCart,onClearCart:u.clearCart},null,8,["cart","onRemoveFromCart","onClearCart"])):(0,n.Q3)("",!0),"ProductList"===i.activeComponent?((0,n.uX)(),(0,n.CE)("button",{key:2,onClick:e[0]||(e[0]=(...t)=>u.changeComponent&&u.changeComponent(...t)),class:"btn btn-primary m-3"},"Proceed to Checkout ("+(0,s.v_)(u.cartItemCount)+")",1)):(0,n.Q3)("",!0)])])}r(4114);const u=t=>((0,n.Qi)("data-v-caadc6ca"),t=t(),(0,n.jt)(),t),l={class:"container mt-4"},d=u((()=>(0,n.Lk)("h1",null,"Checkout Page",-1))),h={class:"card-body"},m=["onClick"],p={class:"form-group"},v=u((()=>(0,n.Lk)("label",null,"Name: ",-1))),f={class:"form-group"},C=u((()=>(0,n.Lk)("label",null,"Phone number: ",-1))),k=["disabled"],b={key:0,style:{color:"red"}},L={key:1,style:{color:"green"}};function y(t,e,r,a,c,i){return(0,n.uX)(),(0,n.CE)("div",l,[d,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(i.cartItems,(t=>((0,n.uX)(),(0,n.CE)("div",{key:t._id,class:"card mb-3"},[(0,n.Lk)("div",h,[(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,(0,s.v_)(t.title),1),(0,n.eW)(" (Quantity: "+(0,s.v_)(t.quantity)+")",1)]),(0,n.Lk)("p",null,"Location: "+(0,s.v_)(t.location),1),(0,n.Lk)("p",null,"Price: $"+(0,s.v_)(t.price),1),(0,n.Lk)("button",{onClick:e=>i.removeFromCart(t),class:"btn btn-danger"},"Remove",8,m)])])))),128)),(0,n.Lk)("div",p,[v,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.name=t),type:"text",pattern:"^[a-zA-Z\\s]+$",required:"",class:"form-control"},null,512),[[o.Jo,c.name]])]),(0,n.Lk)("div",f,[C,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.phone=t),type:"text",pattern:"^\\d+$",required:"",class:"form-control"},null,512),[[o.Jo,c.phone]])]),(0,n.Lk)("button",{disabled:!i.validForm,onClick:e[2]||(e[2]=(...t)=>i.checkout&&i.checkout(...t)),class:"btn btn-primary"},"Checkout",8,k),i.validForm?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("p",b,"Please fill out all fields correctly.")),c.checkoutMessage?((0,n.uX)(),(0,n.CE)("p",L,(0,s.v_)(c.checkoutMessage),1)):(0,n.Q3)("",!0)])}var g={name:"CheckoutComponent",props:{cart:{type:Array,required:!0}},data(){return{name:"",phone:"",checkoutMessage:""}},computed:{cartItems(){return this.cart},validForm(){return""!==this.name.trim()&&this.phone.match(/^\d+$/)}},methods:{removeFromCart(t){this.$emit("remove-from-cart",t)},async checkout(){if(this.validForm)try{const t={lessons:this.cartItems,username:this.name,phonenumber:this.phone},e=await fetch("https://cst-3145-cw-2.vercel.app/collection/orders/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`Error creating order: ${e.statusText}`);this.checkoutMessage=`Order created successfully for ${this.name} (phone: ${this.phone})!`,this.$emit("clear-cart"),setTimeout((()=>{this.$router.push("/")}),2e3)}catch(t){console.error("Error:",t.message),alert(`Failed to create order: ${t.message}`)}}}},w=r(1241);const O=(0,w.A)(g,[["render",y],["__scopeId","data-v-caadc6ca"]]);var P=O;const _={class:"row"},S={class:"card mb-3 mt-3 rounded border border-success-subtle"},A={class:"card-header d-flex"},E={class:"card-body"},F={class:"card-footer"},I=["onClick","disabled"],T=["onClick"];function $(t,e,r,o,a,c){return(0,n.uX)(),(0,n.CE)("div",_,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.sortedLessons,(t=>((0,n.uX)(),(0,n.CE)("div",{class:"col-sm-6",key:t.id},[(0,n.Lk)("div",S,[(0,n.Lk)("div",A,[(0,n.Lk)("div",null,[(0,n.Lk)("h5",null,"Title: "+(0,s.v_)(t.title),1)]),(0,n.Lk)("i",{class:(0,s.C4)([t.icon,"fs-1 ms-auto"])},null,2)]),(0,n.Lk)("div",E,[(0,n.Lk)("i",{class:(0,s.C4)(a.lessons.icon)},null,2),(0,n.Lk)("p",null,"Price: "+(0,s.v_)(t.price)+" AED",1),(0,n.Lk)("p",null,"Spaces: "+(0,s.v_)(t.spaces),1),(0,n.Lk)("p",null,"Location: "+(0,s.v_)(t.location),1)]),(0,n.Lk)("div",F,[(0,n.Lk)("button",{class:"btn btn-info rounded",onClick:e=>c.addToCart(t),disabled:0===t.spaces}," Add to cart ",8,I),(0,n.Lk)("button",{class:"btn btn-danger rounded",onClick:e=>c.removeProduct(t)}," Remove ",8,T)])])])))),128))])}var X={name:"ProductList",data(){return{showProduct:!0,lessons:[],cart:JSON.parse(localStorage.getItem("cart"))||[],searchTerm:"",sortAttribute:"title",sortOrder:"asc",sortedLessons:[]}},created(){this.getLessons()},methods:{async getLessons(){try{const t=await fetch("https://cst-3145-cw-2.vercel.app/collection/Products/");this.lessons=await t.json(),this.searchLessons()}catch(t){console.error("Error fetching lessons:",t)}},searchLessons(){const t=this.searchTerm.toLowerCase();this.sortedLessons=this.lessons.filter((e=>e.title.toLowerCase().includes(t)||e.location.toLowerCase().includes(t))).sort(((t,e)=>{let r=0;return r="string"===typeof t[this.sortAttribute]?t[this.sortAttribute].localeCompare(e[this.sortAttribute]):t[this.sortAttribute]-e[this.sortAttribute],"asc"===this.sortOrder?r:-r}))},addToCart(t){if(t.spaces>0){t.spaces--;const e=this.cart.find((e=>e.lesson.id===t.id));e?e.amount++:this.cart.push({lesson:t,amount:1}),localStorage.setItem("cart",JSON.stringify(this.cart)),this.$emit("add-to-cart",t)}},removeProduct(t){const e=this.cart.findIndex((e=>e.lesson.id===t.id));-1!==e&&(this.cart[e].amount--,t.spaces++,0===this.cart[e].amount&&this.cart.splice(e,1),localStorage.setItem("cart",JSON.stringify(this.cart)),this.$emit("remove-from-cart",t))},showCheckOut(){this.showProduct=!this.showProduct}},computed:{cartSize(){return this.cart.reduce(((t,e)=>t+e.amount),0)}}};const x=(0,w.A)(X,[["render",$]]);var J=x,j={name:"App",components:{ProductList:J,CheckoutComponent:P},data(){return{cart:JSON.parse(localStorage.getItem("cart"))||[],activeComponent:"ProductList"}},computed:{cartItemCount(){return this.cart.reduce(((t,e)=>t+e.quantity),0)}},methods:{changeComponent(){this.activeComponent="ProductList"===this.activeComponent?"CheckoutComponent":"ProductList"},addToCart(t){if(t.spaces>0){const e=this.cart.find((e=>e._id===t._id));e?e.quantity++:this.cart.push({...t,quantity:1}),t.spaces--,localStorage.setItem("cart",JSON.stringify(this.cart))}},removeFromCart(t){const e=this.cart.findIndex((e=>e._id===t._id));-1!==e&&(this.cart[e].quantity>1?this.cart[e].quantity--:this.cart.splice(e,1),localStorage.setItem("cart",JSON.stringify(this.cart)))},clearCart(){this.cart=[],localStorage.setItem("cart",JSON.stringify(this.cart))}}};const q=(0,w.A)(j,[["render",i]]);var N=q;(0,o.Ef)(N).mount("#app")}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var s=e[o]={exports:{}};return t[o].call(s.exports,s,s.exports,r),s.exports}r.m=t,function(){var t=[];r.O=function(e,o,n,s){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],n=t[l][1],s=t[l][2];for(var c=!0,i=0;i<o.length;i++)(!1&s||a>=s)&&Object.keys(r.O).every((function(t){return r.O[t](o[i])}))?o.splice(i--,1):(c=!1,s<a&&(a=s));if(c){t.splice(l--,1);var u=n();void 0!==u&&(e=u)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[o,n,s]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};r.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,s,a=o[0],c=o[1],i=o[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(n in c)r.o(c,n)&&(r.m[n]=c[n]);if(i)var l=i(r)}for(e&&e(o);u<a.length;u++)s=a[u],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(l)},o=self["webpackChunkcoursework3"]=self["webpackChunkcoursework3"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(2530)}));o=r.O(o)})();
//# sourceMappingURL=app.a0ce52fe.js.map